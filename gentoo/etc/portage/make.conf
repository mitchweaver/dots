#=/=/=/=/=/=/=/=/=/=/=/=/=/=/=/=/=/=/=/=/=/=/=/=/=/=/=/=/=/=/=/=/=/=/=/=/=/
#
#     .vir.                                d$b
#  .d$$$$$$b.    .cd$$b.     .d$$b.   d$$$$$$$$$$$b  .d$$b.      .d$$b.
#  $$$$( )$$$b d$$$()$$$.   d$$$$$$$b Q$$$$$$$P$$$P.$$$$$$$b.  .$$$$$$$b.
#  Q$$$$$$$$$$B$$$$$$$$P"  d$$$PQ$$$$b.   $$$$.   .$$$P' `$$$ .$$$P' `$$$
#    "$$$$$$$P Q$$$$$$$b  d$$$P   Q$$$$b  $$$$b   $$$$b..d$$$ $$$$b..d$$$
#   d$$$$$$P"   "$$$$$$$$ Q$$$     Q$$$$  $$$$$   `Q$$$$$$$P  `Q$$$$$$$P
#  $$$$$$$P       `"""""   ""        ""   Q$$$P     "Q$$$P"     "Q$$$P"
#  `Q$$P"                                  """
#
# $ /etc/portage/make.conf
#
# https://github.com/mitchweaver/gentoo
#
#=/=/=/=/=/=/=/=/=/=/=/=/=/=/=/=/=/=/=/=/=/=/=/=/=/=/=/=/=/=/=/=/=/=/=/=/=/

# ======================================================
# PORTAGE SETTINGS
# ======================================================
EMERGE_DEFAULT_OPTS="--ask --ask-enter-invalid --verbose --alphabetical --read-news n --fuzzy-search y"
FEATURES="fail-clean parallel-fetch parallel-install strict network-sandbox ipc-sandbox pid-sandbox userpriv userfetch compress-build-logs compressdebug nodoc noinfo unknown-features-warn -news -ccache -distcc"
ACCEPT_LICENSE="-* @FREE @BINARY-REDISTRIBUTABLE GPL-2.0 GPL-3.0 OSL-3.0 CC-BY-SA-* MIT"
GENTOO_MIRRORS="http://distfiles.gentoo.org"
L10N="en-US en l10n_en-US"
LC_MESSAGES=C
PORTDIR=/var/db/repos/gentoo
DISTDIR=/var/cache/distfiles
PKGDIR=/var/cache/binpkgs
PORTAGE_LOG_DIR=/var/log/portage
PORTAGE_NICENESS=19
PORTAGE_SCHEDULING_POLICY="idle"
NTHREADS=auto
FONT_TYPES="otf ttf"

# ======================================================
# LANGUAGE TARGETS
# ======================================================
LUA_SINGLE_TARGET="lua5-1"
################PYTHON_TARGETS="python3_11"

# ======================================================
# COMPILER FLAGS
# ======================================================
source /etc/portage/make.conf.performance
source /etc/portage/make.conf.hardening

COMMON_FLAGS="$COMMON_FLAGS $COMMON_FLAGS_PERFORMANCE $COMMON_FLAGS_HARDENING"
CFLAGS="${COMMON_FLAGS} $CFLAGS -w"
CPPFLAGS="${COMMON_FLAGS} $CPPFLAGS"
CXXFLAGS="${COMMON_FLAGS} $CXXFLAGS"
FCFLAGS="${COMMON_FLAGS} $FCFLAGS"
FFLAGS="${COMMON_FLAGS} $FFLAGS"
RUSTFLAGS="-C target-cpu=native -C opt-level=3 -C link-arg=-Wl,-z,pack-relative-relocs"

# use mold linker
# see /etc/portage/env/no-mold.conf for packages that break
# (need commented out to merge mold first obviously)
LDFLAGS="-fuse-ld=mold -Wl,-O3 -Wl,--as-needed -Wl,--hash-style=gnu"

# ======================================================
# MACHINE SPECIFIC
# ======================================================
source /etc/portage/make.conf.thinkpad
#####################source /etc/portage/make.conf.desktop

# ======================================================
# ARCHITECTURE SPECIFIC
# ======================================================
source /etc/portage/make.conf.intel
source /etc/portage/make.conf.hardening-amd64

# ======================================================
# LIBC SPECIFIC
# ======================================================
source /etc/portage/make.conf.hardening-glibc

################## MUSL ####################
############elibc-musl musl 
############################################

# ======================================================
# USE FLAGS
# ======================================================
USE="\
# ======================================================
# Positive Use Flags
# ======================================================
# DESKTOP
X wayland bluetooth alsa pipewire screencast man \
libnotify fontconfig icu appindicator cups jumbo-build \
# GRAPHICS
vulkan opengl egl \
# SECURITY
hardened cet seccomp caps filecaps \
# openrc/no-systemd
elogind udev dbus \
# MINIMAL / OPEN ALTERNATIVES
libedit openmp openipmi \
# CODECS
gif png jpeg svg webp mp3 flac vorbis ogg vpx theora v4l \
v4l2 pdf avif vaapi vdpau opus epub mobi pdf nvenc \
# LANGUAGE VERSIONS
lua_single_target_lua5-1 \
# GENTOO_SPECIFIC
branding \
# FONTS
otf font_types_otf nls cjk freetype \
# ======================================================
# DEFAULT NO X86
# ======================================================
-abi_x86_32 \
# ======================================================
# GNOME - note: if using gnome, turn on these flags only
#               for packages that need them
# ======================================================
-gnome -gnome-keyring -introspection -cairo -eds -vala -libadwaita \
-adwaita -gnome-shell -gnome-online-accounts -goa -nautilus -gnome-terminal \
# ======================================================
# NEGATIVE KDE (if using kde, keep qt6 and qml)
# ======================================================
-kf6compat -kwallet -kaccounts -telepathy -semantic-desktop \
-webengine -activities -qt5 -designer -kate -phonon \
-legacy-systray -qt6 -qml \
# ======================================================
# Negative Use Flags
# ======================================================
# SYSTEMD / CRAP WARE
-systemd -resolvconf -polkit -policykit -pulseaudio \
-networkmanager -flatpak -snap \
# OLD X11 STUFF DONT NEED ON WAYLAND
-xinerama -xrandr -xnest -xephyr -xvfb -xcomposite -xscreensaver \
# EXTRA DOCS
-doc -gtk-doc -docs -handbook -examples -extras -test -rdoc -help \
# JIT
# security tradeoff as breaks some memory protections from gentoo hardened
# see: https://packages.gentoo.org/useflags/jit
-jit \
# ONLY ENABLE ON PER-PACKAGE BASIS
-samba -nfs -sftp \
-qt5 -truetype -xml -docx -xmp \
# NEGATIVE FONT CRAP
-ttf -font_types-ttf -bdf -autohint -harfbuzz \
# STUFF I DONT CARE ABOUT
-bindist -profile -lua -luajit -vala -sysprof -colord \
-objc -objc++ -objc-gc -xen -vmware -jack -jack-net -jack-sdk -jack-client \
-ibus -sendto -miners -calendar -alternate-calendar -ccache \
-qmi -mbim -qrtr -crda -vlc -plymouth -webdriver \
# BIOMETRICS IS STUPID
-fprint -fingerprint -howdy \
# I DONT CARE ABOUT SPELLING
-spell -aspell -enchant -hunspell -nuspell \
# PRIVACY
-geoip -geoloc -geolocation -geoclue -telemetry -exif -rdp \
# OBSOLETE_HARDWARE
-dvd -dvdr -vcd -dv -cdda -cdinstall -cdr -bluray \
-a52 -css \
# OBSOLETE_LANGUAGE
-fortran -ada -ocaml -java -oracle -ibm -lisp \
# OBSOLETE CODEC
-tiff \
# DEPRECATED NETWORKING
-wext -ppp -concheck \
# HARDWARE_DONT_CARE
-scanner -joystick -smartcard -wacom -input_devices_wacom -haptic \
# APPLE
-ipod -ios -ieee1394 -dc1394 -aqua -quicktime -xine -coreaudio -apple \
# PROTOCOLS
-kerberos -ldap -zeroconf -gstreamer -nntp -ipv6 \
# ACCESSIBILITY
-accessibility -sox -speex -speech -speechd -scim -ibus -espeak -klatt -mbrola \
# SHELLS I DONT USE
-bash-completion -zsh-completion -fish-completion -bash -zsh -fish \
# EMACS
-emacs -xemacs \
# DEBUG
-valgrind -unwind -debug \
# JUNK
-startup-notification -chromaprint -kvazaar -snappy -chromecast -libcaca -chromium \
# MISC
-cracklib -sendmail -lastfm -nas -oci8 -firebird -afs -emboss -berkdb \
"

# vim:ft=config
